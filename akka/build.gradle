/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
buildscript {
    // 全局变量
    ext {
        akka_version = "2.5.13"
        kotlin_version = "1.2.50"
        netty_version = "4.1.18.Final"
    }

    // 内部仓库
    repositories {
        maven {
            url "http://192.168.189.20:16000/repository/maven-public/"
        }
    }

    // 这里算是定义外部依赖
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
        classpath "org.jetbrains.kotlin:kotlin-noarg:$kotlin_version"
        classpath "org.jetbrains.kotlin:kotlin-allopen:$kotlin_version"
    }
}

group "com.ariane.try"
version "1.0.0-SNAPSHOT"

subprojects {
    // 为子工程引入插件
    apply plugin: "java"
    apply plugin: "kotlin"
    apply plugin: "kotlin-noarg"
    apply plugin: "idea"

    // 引入java插件后，下面的属性会被mix进Project
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8

    [compileJava, compileTestJava, javadoc]*.options*.encoding = 'UTF-8'

    compileJava {
        // 启用在单独的daemon进程中编译
        options.fork = true
    }

    kotlin {
        experimental {
            // 不允许使用kotlin的协程
            coroutines = "error"
        }
    }

    configure([compileKotlin, compileTestKotlin]) {
        kotlinOptions {
            // Generate metadata for Java 1.8 reflection on method parameters
            javaParameters = true

            // Target version of the generated JVM bytecode (1.6 or 1.8), default is 1.6
            jvmTarget = "1.8"
        }
    }

    repositories {
        maven {
            url "http://192.168.189.20:16000/repository/maven-public/"
        }
    }

    dependencies {
        compile("org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version")
        compile("org.jetbrains.kotlin:kotlin-reflect:$kotlin_version")
        compile("com.typesafe.akka:akka-actor_2.12:$akka_version")
        compile("com.typesafe.akka:akka-slf4j_2.12:$akka_version")
        compile("com.typesafe.akka:akka-cluster-sharding_2.12:$akka_version")
        compile("com.typesafe.akka:akka-cluster-metrics_2.12:$akka_version")
        compile("com.typesafe.akka:akka-distributed-data_2.12:$akka_version")

        compile("io.netty:netty-all:$netty_version")
        
        testCompile("com.typesafe.akka:akka-testkit_2.12:$akka_version")
        testCompile("junit:junit:4.12")
    }
}